<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="id.walt.essif.DidRegistrationTest" tests="1" skipped="0" failures="0" errors="0" timestamp="2024-09-12T09:39:43" hostname="pablito-B550-AORUS-ELITE-V2" time="0.003">
  <properties/>
  <testcase name="testEbsiDidRegistration" classname="id.walt.essif.DidRegistrationTest" time="0.003"/>
  <system-out><![CDATA[1. [EWallet] Generate ETH address (keys)
2. [EWallet] Generate DID Controlling Keys)
3. [EWallet] Store DID Controlling Private Key
4. [EWallet] Generate DID Document
5. [EWallet] POST /onboards
6. [Eos] Request DID ownership
7. [EWallet] Signed Challenge
8. [Eos] Validate DID Document
9. [Eos] GET /identifiers/{did}
10. [Eos] 404 Not found
11. [Eos] Generate Verifiable Authorization
12. [EWallet] 201 V. Authorization
13 [POST] /insertDidDocument
14 Validate request
15 Generate <unsigned transaction>
16. [EWallet] 200 <unsigned transaction>
17. [EWallet] Generate <signed transaction>
]]></system-out>
  <system-err><![CDATA[8225 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.services.ecosystems.essif.enterprisewallet.EnterpriseWalletService - didOwnershipReq: {
    "request": "<JWT-response>"
}

8225 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.services.ecosystems.essif.enterprisewallet.EnterpriseWalletService - didOwnershipReqHeader:{
    "alg": "ES256K",
    "typ": "JWT",
    "jwk": "{EOS-DID Key}"
}

8225 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.services.ecosystems.essif.enterprisewallet.EnterpriseWalletService - didOwnershipReqBody: {
    "id": "<random-id>",
    "iss": "did:ebsi:2123456789AB...fghijkmno",
    "callback": "<callback-url>",
    "nonce": "<random-nonce>"
}

8226 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.services.ecosystems.essif.enterprisewallet.EnterpriseWalletService - signedChallenge: {
    "request": "<JWT-response>"
}

8226 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.services.ecosystems.essif.TrustedIssuerClient - header: {
    "alg": "ES256K",
    "typ": "JWT",
    "jwk": "{User Wallet-DID Key}"
}

8226 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.services.ecosystems.essif.TrustedIssuerClient - body: {
    "nonce": "<request-nonce>",
    "data": {
        "@context": [
            "https://w3.org/ns/did/v1",
            "https://ebsi.org/ns/did/v1"
        ],
        "id": "did:ebsi:2123456789AB...fghijkmno",
        "verificationMethod": [
            {
                "id": "did:ebsi:2123456789AB...fghijkmno#key-1",
                "type": "Ed25519VerificationKey2018",
                "controller": "did:ebsi:2123456789AB...fghijkmno",
                "publicKeyBase58": "5F5Q1qJbbvcyhnStAmkjF5rUBKe1XnHJHt2Tj49tTDpW"
            },
            {
                "id": "did:ebsi:2123456789AB...fghijkmno#key-2",
                "type": "X25519KeyAgreementKey2019",
                "controller": "did:ebsi:2123456789AB...fghijkmno",
                "publicKeyBase58": "GnxxE5rAFYoRS6af7XArmzh7gNS68XTAKjhNDRsfhrFJ"
            },
            {
                "id": "did:ebsi:2123456789AB...fghijkmno#key-3",
                "type": "EidasVerificationKey2021",
                "controller": "did:ebsi:2123456789AB...fghijkmno",
                "publicKeyPem": "-----BEGIN.."
            }
        ],
        "authentication": [
            "did:ebsi:2123456789AB...fghijkmno#key-3"
        ],
        "assertionMethod": [
            "did:ebsi:2123456789AB...fghijkmno#key-1"
        ],
        "keyAgreement": [
            "did:ebsi:2123456789AB...fghijkmno#key-2"
        ],
        "proof": {
            "type": "Ed25519Signature2018",
            "created": "2019-06-22T14:11:44Z",
            "proofPurpose": "assertionMethod",
            "verificationMethod": "did:ebsi:2123456789AB...fghijkmno#key-1",
            "jws": "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk"
        }
    }
}

8227 [pool-1-thread-1 @coroutine#233] DEBUG id.walt.essif.DidRegistrationTest - verifiableAuthoriztation: {
    "@context": [
        "https://www.w3.org/2018/credentials/v1",
        "https://essif.europa.eu/schemas/vc/2020/v1"
    ],
    "id": "did:ebsi:2123456789AB...fghijkmno/credentials/1872",
    "type": [
        "VerifiableCredential",
        "VerifiableAuthorization"
    ],
    "issuer": "did:ebsi:2123456789AB...fghijkmno",
    "issuanceDate": "2020-08-24T14:13:44Z",
    "credentialSubject": {
        "id": "did:ebsi:00000004321",
        "hash": "0x31a014c390aa9ad2b47a1df8904c8addf87db279b06eae50797f546da63229d3"
    },
    "proof": {
        "type": "EcdsaSecp256k1Signature2019",
        "created": "2020-08-24T14:13:44Z",
        "proofPurpose": "assertionMethod",
        "verificationMethod": "did:ebsi:2123456789AB...fghijkmno#key-1",
        "jws": "eyJhbGciOiJSUzI1NiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..TCYt5X"
    }
}

]]></system-err>
</testsuite>
